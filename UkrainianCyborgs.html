<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ukrainian Cyborgs</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    <style>
        /* --- C Y B E R P U N K   S T Y L E --- */
        :root {
            --primary: #00BFFF;    /* Electric Blue */
            --accent: #FFD700;     /* Cyber Yellow */
            --bg-dark: #050505;    /* Deep Black */
            --card-bg: #141414;
            --danger: #ff3b30;
            --glow: 0 0 15px rgba(0, 191, 255, 0.6);
        }

        body {
            font-family: 'Courier New', Courier, monospace; /* –¢–µ—Ö–Ω–æ-—à—Ä–∏—Ñ—Ç */
            background-color: var(--bg-dark);
            color: #ffffff;
            margin: 0; padding: 0;
            display: flex; flex-direction: column; align-items: center;
            height: 100vh; overflow: hidden;
            user-select: none; -webkit-user-select: none;
            touch-action: manipulation;
        }

        /* –ê–Ω—ñ–º–æ–≤–∞–Ω–∏–π —Ñ–æ–Ω (–ú–∞—Ç—Ä–∏—Ü—è) */
        .bg-fx {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at 50% 50%, #1a2a3a 0%, #000000 90%);
            z-index: -2;
        }

        /* --- –ï–ö–†–ê–ù –ó–ê–í–ê–ù–¢–ê–ñ–ï–ù–ù–Ø (INTRO) --- */
        #intro-layer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 9999;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            cursor: pointer; transition: opacity 0.8s;
        }
        .intro-text {
            color: var(--primary); font-size: 16px; letter-spacing: 2px;
            animation: pulse 1.5s infinite; text-align: center;
        }
        .intro-sub { color: #555; font-size: 10px; margin-top: 10px; }
        @keyframes pulse { 0% { opacity: 0.5; text-shadow: 0 0 5px var(--primary); } 100% { opacity: 1; text-shadow: 0 0 20px var(--primary); } }

        /* --- MAIN UI --- */
        .container { width: 100%; max-width: 420px; padding: 15px; box-sizing: border-box; text-align: center; z-index: 1; }

        h1 {
            font-family: sans-serif; color: #fff; font-size: 20px; text-transform: uppercase;
            letter-spacing: 3px; margin-top: 5px;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }

        /* –ë–∞–ª–∞–Ω—Å */
        .balance-wrap { margin: 15px 0; position: relative; }
        .balance-val { font-size: 42px; font-weight: 800; font-family: sans-serif; text-shadow: var(--glow); }
        .balance-label { font-size: 12px; color: var(--accent); letter-spacing: 1px; }

        /* –ê–†–¢ –ö–ù–û–ü–ö–ê (–¢–†–ò–ó–£–ë) */
        .clicker-area {
            flex-grow: 1; display: flex; justify-content: center; align-items: center;
            margin: 20px 0; position: relative;
        }
        .main-btn {
            width: 280px; height: 280px; border-radius: 50%;
            background: radial-gradient(circle, #152b3c, #000);
            border: 2px solid rgba(0, 191, 255, 0.3);
            box-shadow: 0 0 30px rgba(0, 191, 255, 0.1);
            display: flex; justify-content: center; align-items: center;
            cursor: pointer; transition: transform 0.05s, box-shadow 0.2s;
            -webkit-tap-highlight-color: transparent;
            position: relative; overflow: hidden;
        }
        .main-btn:active { transform: scale(0.97); border-color: var(--accent); box-shadow: 0 0 50px rgba(255, 215, 0, 0.3); }

        /* SVG Art */
        .trident-svg {
            width: 75%; height: 75%;
            filter: drop-shadow(0 0 10px rgba(0, 191, 255, 0.8));
            transition: filter 0.3s;
        }
        /* –ê–Ω—ñ–º–∞—Ü—ñ—è "–î–∏—Ö–∞–Ω–Ω—è" –¥–ª—è —Ç—Ä–∏–∑—É–±–∞ */
        @keyframes breathe { 0% { transform: scale(1); } 50% { transform: scale(1.02); } 100% { transform: scale(1); } }
        .trident-active { animation: breathe 3s infinite ease-in-out; }

        /* –ì—Ä–∞–¥—ñ—î–Ω—Ç –¥–ª—è SVG */
        .stop1 { stop-color: var(--primary); }
        .stop2 { stop-color: var(--accent); }

        /* –ï–Ω–µ—Ä–≥—ñ—è */
        .energy-bar {
            width: 100%; height: 12px; background: #111; border-radius: 6px;
            border: 1px solid #333; overflow: hidden; position: relative; margin-top: 10px;
        }
        .energy-fill {
            height: 100%; background: linear-gradient(90deg, var(--primary), #0055ff);
            width: 100%; transition: width 0.5s linear;
            box-shadow: 0 0 10px var(--primary);
        }
        .energy-text {
            display: flex; justify-content: space-between; font-size: 12px; 
            color: #aaa; margin-top: 5px; font-family: sans-serif;
        }

        /* –ù–∞–≤—ñ–≥–∞—Ü—ñ—è */
        .nav-bar {
            position: fixed; bottom: 15px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 400px; background: rgba(20, 20, 20, 0.9);
            backdrop-filter: blur(10px); border-radius: 20px; border: 1px solid #333;
            display: flex; justify-content: space-around; padding: 12px; z-index: 100;
        }
        .nav-btn {
            background: none; border: none; color: #666; font-size: 10px;
            display: flex; flex-direction: column; align-items: center; cursor: pointer;
        }
        .nav-btn.active { color: var(--accent); text-shadow: 0 0 10px var(--accent); }
        .nav-icon { font-size: 20px; margin-bottom: 4px; }

        /* Modals */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 2000; justify-content: center; align-items: flex-end; }
        .modal-card {
            background: #111; width: 100%; max-width: 500px; border-radius: 25px 25px 0 0;
            padding: 25px; max-height: 85vh; overflow-y: auto; border-top: 2px solid var(--primary);
            animation: slideUp 0.3s; position: relative;
        }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        .close-x { position: absolute; top: 20px; right: 20px; font-size: 24px; color: #666; cursor: pointer; }
        
        /* Upgrades List */
        .upg-item {
            display: flex; justify-content: space-between; align-items: center;
            background: #1a1a1a; padding: 15px; border-radius: 12px; margin-bottom: 10px;
            border: 1px solid #333;
        }
        .upg-info h4 { margin: 0; color: #fff; font-size: 14px; }
        .upg-info p { margin: 5px 0 0; font-size: 10px; color: #888; }
        .buy-btn {
            background: var(--primary); color: #000; border: none; padding: 8px 15px;
            border-radius: 8px; font-weight: bold; font-size: 12px; cursor: pointer;
        }
        .buy-btn:disabled { background: #333; color: #555; }

        .floating-txt { position: absolute; font-weight: bold; font-size: 24px; color: #fff; pointer-events: none; animation: float 0.8s forwards; }
        @keyframes float { to { transform: translateY(-80px); opacity: 0; } }

    </style>
</head>
<body>

    <div id="intro-layer" onclick="startGame()">
        <div class="intro-text" id="intro_txt">
            SYSTEM DETECTED<br>
            INITIALIZING PROTOCOL...
        </div>
        <div class="intro-sub" id="intro_sub">
            [ TAP TO ACTIVATE ]
        </div>
    </div>

    <div class="bg-fx"></div>

    <div class="container">
        <h1 id="ui_title">UKRAINIAN CYBORGS</h1>

        <div class="balance-wrap">
            <div class="balance-val" id="displayBalance">0</div>
            <div class="balance-label">UCBG COIN</div>
        </div>

        <div class="clicker-area">
            <div class="main-btn" id="tapBtn">
                <svg class="trident-svg trident-active" viewBox="0 0 512 512">
                    <defs>
                        <linearGradient id="ua_grad" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" class="stop1" />
                            <stop offset="100%" class="stop2" />
                        </linearGradient>
                        <filter id="glow" x="-20%" y="-20%" width="140%" height="140%">
                            <feGaussianBlur stdDeviation="4" result="blur" />
                            <feComposite in="SourceGraphic" in2="blur" operator="over" />
                        </filter>
                    </defs>
                    <path fill="url(#ua_grad)" filter="url(#glow)" d="M256 32C242.7 32 232 42.7 232 56V192C232 222.9 206.9 248 176 248C145.1 248 120 222.9 120 192V88C120 74.7 109.3 64 96 64C82.7 64 72 74.7 72 88V192C72 249.4 118.6 296 176 296H200V424H152C138.7 424 128 434.7 128 448C128 461.3 138.7 472 152 472H360C373.3 472 384 461.3 384 448C384 434.7 373.3 424 360 424H312V296H336C393.4 296 440 249.4 440 192V88C440 74.7 429.3 64 416 64C402.7 64 392 74.7 392 88V192C392 222.9 366.9 248 336 248C305.1 248 280 222.9 280 192V56C280 42.7 269.3 32 256 32z"/>
                </svg>
            </div>
        </div>

        <div class="energy-bar">
            <div class="energy-fill" id="energyFill"></div>
        </div>
        <div class="energy-text">
            <span>‚ö° <span id="enVal">1000</span> / <span id="enMax">1000</span></span>
            <span id="regenLabel">Charging...</span>
        </div>
    </div>

    <div class="nav-bar">
        <button class="nav-btn active" onclick="closeModals()">
            <div class="nav-icon">üè†</div><span id="nav_main">Base</span>
        </button>
        <button class="nav-btn" onclick="openModal('upgModal')">
            <div class="nav-icon">üõ†</div><span id="nav_upg">Upgrade</span>
        </button>
        <button class="nav-btn" onclick="openModal('friendsModal')">
            <div class="nav-icon">üë•</div><span id="nav_team">Team</span>
        </button>
        <button class="nav-btn" onclick="openModal('walletModal')">
            <div class="nav-icon">üíé</div><span id="nav_wallet">Wallet</span>
        </button>
    </div>

    <div id="upgModal" class="modal">
        <div class="modal-card">
            <span class="close-x" onclick="closeModals()">&times;</span>
            <h2 id="txt_arsenal">–ê–†–°–ï–ù–ê–õ (–†—ñ–≤–Ω—ñ)</h2>
            <div id="upgradesList"></div>
        </div>
    </div>

    <div id="friendsModal" class="modal">
        <div class="modal-card">
            <span class="close-x" onclick="closeModals()">&times;</span>
            <h2>–ë—Ä–∏–≥–∞–¥–∞</h2>
            <p style="color:#888; font-size:12px;">–ó–∞–ø—Ä–æ—Å–∏ –±—ñ–π—Ü—è - –æ—Ç—Ä–∏–º–∞–π +2500</p>
            <button class="buy-btn" style="width:100%; margin-top:20px;" onclick="invite()">–ó–∞–ø—Ä–æ—Å–∏—Ç–∏</button>
        </div>
    </div>

    <div id="walletModal" class="modal">
        <div class="modal-card">
            <span class="close-x" onclick="closeModals()">&times;</span>
            <h2>–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è</h2>
            <div id="ton-connect-button" style="width:100%; display:flex; justify-content:center;"></div>
            <div style="text-align:center; margin-top:20px; color:#555; font-size:12px;">
                üîí –í–∏–≤—ñ–¥ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ –¥–æ 05.02.2026
            </div>
        </div>
    </div>

    <script>
        // --- 1. CONFIGURATION & LOCALE ---
        const TG = window.Telegram.WebApp;
        TG.expand();
        TG.setHeaderColor('#050505');

        // Auto-detect language from Telegram (No GPS needed)
        const userLang = TG.initDataUnsafe?.user?.language_code || 'uk'; 
        const lang = (userLang === 'ru' || userLang === 'be') ? 'ru' : (userLang === 'uk' ? 'uk' : 'en');

        const TXT = {
            uk: {
                intro: "–°–ò–°–¢–ï–ú–ê –í–ò–Ø–í–õ–ï–ù–ê<br>–Ü–ù–Ü–¶–Ü–ê–õ–Ü–ó–ê–¶–Ü–Ø...", tap_intro: "[ –ù–ê–¢–ò–°–ù–ò –©–û–ë –ê–ö–¢–ò–í–£–í–ê–¢–ò ]",
                title: "UKRAINIAN CYBORGS", main: "–ë–∞–∑–∞", upg: "–ü—Ä–æ–∫–∞—á–∫–∞", team: "–ë—Ä–∏–≥–∞–¥–∞", wallet: "–í–∏–≤—ñ–¥",
                arsenal: "–ê–†–°–ï–ù–ê–õ",
                u_tap: "–ü–æ—Ç—É–∂–Ω—ñ—Å—Ç—å —É–¥–∞—Ä—É", u_eng: "–ó–∞–ø–∞—Å –µ–Ω–µ—Ä–≥—ñ—ó", u_reg: "–†–µ–≥–µ–Ω–µ—Ä–∞—Ü—ñ—è",
                lvl: "–†—ñ–≤–µ–Ω—å"
            },
            en: {
                intro: "SYSTEM DETECTED<br>INITIALIZING...", tap_intro: "[ TAP TO ACTIVATE ]",
                title: "UKRAINIAN CYBORGS", main: "Base", upg: "Upgrade", team: "Team", wallet: "Wallet",
                arsenal: "ARSENAL",
                u_tap: "Click Power", u_eng: "Energy Limit", u_reg: "Recharge Speed",
                lvl: "Level"
            },
            ru: {
                intro: "–°–ò–°–¢–ï–ú–ê –û–ë–ù–ê–†–£–ñ–ï–ù–ê<br>–ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø...", tap_intro: "[ –ù–ê–ñ–ú–ò –î–õ–Ø –ê–ö–¢–ò–í–ê–¶–ò–ò ]",
                title: "UKRAINIAN CYBORGS", main: "–ë–∞–∑–∞", upg: "–ü—Ä–æ–∫–∞—á–∫–∞", team: "–ë—Ä–∏–≥–∞–¥–∞", wallet: "–í—ã–≤–æ–¥",
                arsenal: "–ê–†–°–ï–ù–ê–õ",
                u_tap: "–ú–æ—â–Ω–æ—Å—Ç—å –∫–ª–∏–∫–∞", u_eng: "–ó–∞–ø–∞—Å —ç–Ω–µ—Ä–≥–∏–∏", u_reg: "–†–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è",
                lvl: "–£—Ä–æ–≤–µ–Ω—å"
            }
        }[lang];

        // --- 2. STATE MANAGEMENT ---
        let game = {
            balance: 0,
            energy: 1000,
            hasPlayed: false, // For 5000 bonus
            upgrades: {
                tap: { lvl: 1, cost: 500, val: 1 },
                energy: { lvl: 1, cost: 500, val: 1000 }, // +500 per lvl
                regen: { lvl: 1, cost: 1000, val: 2 } // +1 per lvl
            }
        };

        // --- 3. LOGIC ---
        
        function init() {
            loadGame();
            
            // New Player Bonus
            if (!game.hasPlayed) {
                game.balance = 5000;
                game.hasPlayed = true;
                saveGame();
            }

            applyTexts();
            updateUI();
            renderUpgrades();
            
            // Regen Loop
            setInterval(() => {
                if (game.energy < game.upgrades.energy.val) {
                    game.energy += game.upgrades.regen.val;
                    if(game.energy > game.upgrades.energy.val) game.energy = game.upgrades.energy.val;
                    updateUI();
                }
            }, 1000); // Every second

            // TON Connect
            new TON_CONNECT_UI.TonConnectUI({
                manifestUrl: 'https://raw.githubusercontent.com/ton-community/tutorials/main/03-client/test/public/tonconnect-manifest.json',
                buttonRootId: 'ton-connect-button'
            });
        }

        function applyTexts() {
            document.getElementById('intro_txt').innerHTML = TXT.intro;
            document.getElementById('intro_sub').innerText = TXT.tap_intro;
            document.getElementById('ui_title').innerText = TXT.title;
            document.getElementById('nav_main').innerText = TXT.main;
            document.getElementById('nav_upg').innerText = TXT.upg;
            document.getElementById('nav_team').innerText = TXT.team;
            document.getElementById('nav_wallet').innerText = TXT.wallet;
            document.getElementById('txt_arsenal').innerText = TXT.arsenal;
        }

        // Intro Clicker
        window.startGame = () => {
            const intro = document.getElementById('intro-layer');
            intro.style.opacity = '0';
            setTimeout(() => intro.style.display = 'none', 800);
        };

        // Main Click
        document.getElementById('tapBtn').addEventListener('pointerdown', (e) => {
            e.preventDefault(); // Prevent zoom
            
            let power = game.upgrades.tap.val + (game.upgrades.tap.lvl - 1); // Base calc
            
            if (game.energy >= power) {
                game.balance += power;
                game.energy -= power;
                
                // Visuals
                const btn = document.querySelector('.main-btn');
                btn.style.transform = "scale(0.95)";
                setTimeout(()=>btn.style.transform="scale(1)", 50);
                
                if(TG.HapticFeedback) TG.HapticFeedback.impactOccurred('light');

                // Floating Text
                let x = e.clientX; let y = e.clientY;
                let f = document.createElement('div');
                f.className = 'floating-txt'; f.innerText = `+${power}`;
                f.style.left = x + 'px'; f.style.top = y + 'px';
                document.body.appendChild(f);
                setTimeout(()=>f.remove(), 800);

                updateUI();
                saveGame();
            }
        });

        // Upgrades System
        function renderUpgrades() {
            const list = document.getElementById('upgradesList');
            list.innerHTML = '';
            
            const data = [
                { id: 'tap', name: TXT.u_tap, desc: "+1 Click" },
                { id: 'energy', name: TXT.u_eng, desc: "+500 Max" },
                { id: 'regen', name: TXT.u_reg, desc: "+Speed" }
            ];

            data.forEach(u => {
                let item = game.upgrades[u.id];
                // Dynamic Cost: Base * 2^(lvl-1)
                let currentCost = item.cost * Math.pow(2, item.lvl - 1);
                
                list.innerHTML += `
                <div class="upg-item">
                    <div class="upg-info">
                        <h4>${u.name} <span style="color:var(--primary)">Lvl ${item.lvl}</span></h4>
                        <p>${u.desc}</p>
                    </div>
                    <button class="buy-btn" onclick="buy('${u.id}', ${currentCost})" ${game.balance < currentCost ? 'disabled' : ''}>
                        ${currentCost.toLocaleString()}
                    </button>
                </div>`;
            });
        }

        window.buy = (id, cost) => {
            if(game.balance >= cost) {
                game.balance -= cost;
                game.upgrades[id].lvl++;
                
                // Apply logic
                if(id === 'energy') game.upgrades.energy.val += 500;
                if(id === 'regen') game.upgrades.regen.val += 1;

                updateUI(); renderUpgrades(); saveGame();
            }
        };

        function updateUI() {
            document.getElementById('displayBalance').innerText = game.balance.toLocaleString();
            
            let cur = Math.floor(game.energy);
            let max = game.upgrades.energy.val;
            document.getElementById('enVal').innerText = cur;
            document.getElementById('enMax').innerText = max;
            
            let pct = (cur / max) * 100;
            document.getElementById('energyFill').style.width = pct + "%";
        }

        window.invite = () => {
             TG.openTelegramLink(`https://t.me/share/url?url=https://t.me/ucbgcoin_bot`);
        }

        // Storage
        function saveGame() { localStorage.setItem('ucbg_v5', JSON.stringify(game)); }
        function loadGame() {
            let s = localStorage.getItem('ucbg_v5');
            if(s) {
                let loaded = JSON.parse(s);
                game = {...game, ...loaded}; // Merge to keep new structure if updated
            }
        }

        window.openModal = (id) => document.getElementById(id).style.display = 'flex';
        window.closeModals = () => document.querySelectorAll('.modal').forEach(el => el.style.display = 'none');

        window.onload = init;
    </script>
</body>
</html>
