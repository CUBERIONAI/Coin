<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ukrainian Cyborgs v5.0: The War</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;600&display=swap" rel="stylesheet">
    
    <style>
        /* --- CORE VARIABLES v5.0 --- */
        :root {
            --primary: #00BFFF;       /* Cyber Blue */
            --accent: #FFD700;        /* Cyber Yellow */
            --danger: #ff2a2a;        /* War Red */
            --military: #4b5320;      /* Olive Green */
            --dark-bg: #050505;
            --panel-bg: rgba(20, 25, 30, 0.95);
            --border-g: 1px solid rgba(0, 191, 255, 0.3);
            
            /* Leagues Colors */
            --l-bronze: #cd7f32;
            --l-silver: #c0c0c0;
            --l-gold: #FFD700;
            --l-diamond: #b9f2ff;
            --l-cyborg: #ff00ff; /* Mythical Level */
        }

        body {
            font-family: 'Exo 2', sans-serif;
            background-color: var(--dark-bg);
            color: #fff; margin: 0; padding: 0;
            display: flex; flex-direction: column; align-items: center;
            height: 100vh; overflow: hidden;
            user-select: none; -webkit-user-select: none;
            -webkit-tap-highlight-color: transparent;
            padding-bottom: 95px; /* Space for Nav */
        }

        /* DYNAMIC BACKGROUND */
        .war-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: 
                radial-gradient(circle at 50% 50%, rgba(0, 20, 40, 0.8), #000),
                url('https://www.transparenttextures.com/patterns/carbon-fibre.png'); 
            z-index: -2;
        }
        .scanlines {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,0) 50%, rgba(0,0,0,0.2) 50%, rgba(0,0,0,0.2));
            background-size: 100% 4px;
            pointer-events: none; z-index: -1; opacity: 0.3;
        }

        /* HEADER */
        .top-bar {
            width: 100%; max-width: 480px; padding: 15px; 
            display: flex; justify-content: space-between; align-items: center;
            box-sizing: border-box; background: linear-gradient(180deg, rgba(0,0,0,0.8), transparent);
        }
        .profile-chip {
            display: flex; align-items: center; gap: 8px;
            background: rgba(255, 255, 255, 0.1); padding: 5px 10px; border-radius: 20px;
            font-size: 12px; border: 1px solid #333;
        }
        
        /* TYPOGRAPHY */
        h1, h2, .font-tech { font-family: 'Orbitron', sans-serif; text-transform: uppercase; letter-spacing: 1px; }
        .text-accent { color: var(--accent); text-shadow: 0 0 10px rgba(255, 215, 0, 0.5); }
        .text-danger { color: var(--danger); text-shadow: 0 0 10px rgba(255, 42, 42, 0.5); }
    </style>
        /* MAIN DISPLAY */
        .container { 
            width: 100%; max-width: 480px; padding: 0 15px; 
            flex-grow: 1; display: flex; flex-direction: column; align-items: center;
            z-index: 1; position: relative;
        }
    
        .balance-container { text-align: center; margin-top: 10px; }
        .balance-val { font-size: 42px; font-weight: 900; font-family: 'Orbitron', sans-serif; }
        .league-btn {
            background: rgba(0,0,0,0.5); border: 1px solid #555;
            padding: 5px 15px; border-radius: 15px; font-size: 12px;
            cursor: pointer; margin-top: 5px; display: inline-block;
            transition: 0.3s;
        }

        /* CLICKER */
        .clicker-zone {
            flex-grow: 1; display: flex; justify-content: center; align-items: center;
            position: relative; width: 100%;
        }
        .main-btn {
            width: 280px; height: 280px; border-radius: 50%;
            background: radial-gradient(circle, #1a2f3d, #000);
            border: 4px solid #333;
            box-shadow: 0 0 40px rgba(0, 191, 255, 0.15);
            display: flex; justify-content: center; align-items: center;
            position: relative; cursor: pointer; transition: transform 0.08s cubic-bezier(0.1, 0.7, 1.0, 0.1);
            -webkit-touch-callout: none;
        }
        .main-btn:active { transform: scale(0.95); }
        
        /* DIAMOND & WAR EFFECTS */
        .mode-war { box-shadow: 0 0 50px var(--danger), inset 0 0 30px var(--danger) !important; border-color: var(--danger) !important; }
        .mode-diamond { animation: pulseDia 2s infinite; border-color: var(--l-diamond) !important; }
        @keyframes pulseDia { 0% { box-shadow: 0 0 30px var(--l-diamond); } 50% { box-shadow: 0 0 60px var(--l-diamond); } 100% { box-shadow: 0 0 30px var(--l-diamond); } }

        .trident-svg { width: 65%; height: 65%; filter: drop-shadow(0 0 10px var(--primary)); pointer-events: none; }
        
        /* PANELS */
        .bot-panel {
            width: 100%; background: linear-gradient(90deg, rgba(0,191,255,0.1), transparent);
            border-left: 3px solid var(--primary); padding: 10px;
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 15px; border-radius: 0 10px 10px 0;
        }

        /* ENERGY */
        .energy-cont { width: 100%; margin-bottom: 10px; }
        .energy-bar { height: 8px; background: #222; border-radius: 4px; overflow: hidden; position: relative; }
        .energy-fill { height: 100%; background: linear-gradient(90deg, var(--primary), var(--accent)); width: 100%; transition: width 0.3s; }
        .energy-txt { display: flex; justify-content: space-between; font-size: 11px; margin-top: 5px; color: #aaa; }

        /* FLOATING TEXT */
        .float-txt {
            position: absolute; font-weight: 900; font-size: 28px;
            pointer-events: none; animation: floatUp 0.8s forwards;
            color: #fff; text-shadow: 0 0 5px var(--primary); z-index: 100;
        }
        @keyframes floatUp { 0% { opacity: 1; transform: translateY(0) scale(1); } 100% { opacity: 0; transform: translateY(-80px) scale(1.5); } }

        /* MODALS */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 2000; justify-content: center; align-items: flex-end; }
        .modal-card { 
            background: #141414; width: 100%; max-width: 500px; 
            border-radius: 25px 25px 0 0; padding: 25px; max-height: 85vh; overflow-y: auto; 
            border-top: 2px solid var(--primary); position: relative;
        }
        .modal-h { font-size: 20px; margin-bottom: 20px; border-bottom: 1px solid #333; padding-bottom: 10px; }
        .close-btn { position: absolute; top: 20px; right: 20px; font-size: 24px; color: #666; cursor: pointer; }

        /* LIST ITEMS */
        .item-row { display: flex; justify-content: space-between; align-items: center; background: #1f1f1f; padding: 12px; border-radius: 10px; margin-bottom: 8px; border: 1px solid #333; }
        .btn { background: var(--primary); color: #000; border: none; padding: 8px 16px; border-radius: 8px; font-weight: bold; cursor: pointer; font-family: 'Exo 2'; }
        .btn-ton { background: #0088cc; color: #fff; }
        .btn:disabled { background: #333; color: #555; }

        /* NAVIGATION */
        .nav-bar {
            position: fixed; bottom: 15px; left: 50%; transform: translateX(-50%);
            width: 94%; max-width: 460px; background: rgba(20, 20, 20, 0.95);
            backdrop-filter: blur(10px); border-radius: 20px; border: 1px solid #333;
            display: flex; justify-content: space-around; padding: 10px 0; z-index: 100; box-shadow: 0 10px 30px #000;
        }
        .nav-btn { background: none; border: none; color: #666; font-size: 10px; display: flex; flex-direction: column; align-items: center; cursor: pointer; width: 20%; }
        .nav-btn.active { color: var(--primary); }
        .nav-icon { font-size: 20px; margin-bottom: 4px; }
    </style>
</head>
<body>
    <div class="war-bg"></div>
    <div class="scanlines"></div>

    <div class="top-bar">
        <div class="profile-chip">
            <span id="userFlag">üá∫üá¶</span>
            <span id="userName">Cyborg</span>
        </div>
        <div id="ton-connect-btn"></div> </div>

    <div class="container">
        
        <div class="balance-container">
            <h2 id="ui_title" class="font-tech text-accent" style="font-size: 16px; margin: 0;">Defense of Kyiv</h2>
            <div class="balance-val"><img src="https://cryptologos.cc/logos/toncoin-ton-logo.png?v=029" style="width:25px; vertical-align:middle; filter:grayscale(1);"> <span id="displayBalance">0</span></div>
            <div class="league-btn" id="leagueDisplay" onclick="openModal('leagueModal')">üèÜ Bronze League</div>
        </div>

        <div class="bot-panel" id="botPanel" style="display:none; margin-top: 20px;">
            <div style="display:flex; align-items:center; gap:10px;">
                <span style="font-size:24px;">ü§ñ</span>
                <div>
                    <div style="font-size:12px; color:#aaa;" data-lang="bot_status">Auto-Defense System</div>
                    <div style="font-family:monospace; font-weight:bold;" id="botTimer">--:--:--</div>
                </div>
            </div>
            <button class="btn" id="claimBotBtn" onclick="claimBot()">CLAIM</button>
        </div>

        <div class="clicker-zone">
            <div class="main-btn" id="tapBtn">
                <svg class="trident-svg" viewBox="0 0 512 512">
                    <defs>
                        <linearGradient id="grad1" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#00BFFF;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#FFD700;stop-opacity:1" />
                        </linearGradient>
                    </defs>
                    <path fill="url(#grad1)" d="M256 32C242.7 32 232 42.7 232 56V192C232 222.9 206.9 248 176 248C145.1 248 120 222.9 120 192V88C120 74.7 109.3 64 96 64C82.7 64 72 74.7 72 88V192C72 249.4 118.6 296 176 296H200V424H152C138.7 424 128 434.7 128 448C128 461.3 138.7 472 152 472H360C373.3 472 384 461.3 384 448C384 434.7 373.3 424 360 424H312V296H336C393.4 296 440 249.4 440 192V88C440 74.7 429.3 64 416 64C402.7 64 392 74.7 392 88V192C392 222.9 366.9 248 336 248C305.1 248 280 222.9 280 192V56C280 42.7 269.3 32 256 32z"/>
                </svg>
            </div>
            <div id="turboMsg" style="display:none; position:absolute; bottom: -40px; color: var(--danger); font-weight: bold; font-family: 'Orbitron'; letter-spacing: 2px;">ROCKET STRIKE ACTIVE</div>
        </div>

        <div class="energy-cont">
            <div class="energy-bar"><div class="energy-fill" id="energyFill"></div></div>
            <div class="energy-txt">
                <span>‚ö° <span id="enVal">1000</span> / <span id="enMax">1000</span></span>
                <span id="regenState">Recharging...</span>
            </div>
        </div>
    </div>
    <div class="nav-bar">
        <button class="nav-btn active" onclick="switchTab('home')"><div class="nav-icon">üõ°Ô∏è</div><span data-lang="nav_base">Base</span></button>
        <button class="nav-btn" onclick="openModal('tasksModal')"><div class="nav-icon">üìù</div><span data-lang="nav_tasks">Missions</span></button>
        <button class="nav-btn" onclick="openModal('warModal')"><div class="nav-icon">‚öîÔ∏è</div><span data-lang="nav_war">War Map</span></button>
        <button class="nav-btn" onclick="openModal('upgModal')"><div class="nav-icon">‚öôÔ∏è</div><span data-lang="nav_upg">Arsenal</span></button>
        <button class="nav-btn" onclick="openModal('shopModal')"><div class="nav-icon">üíé</div><span data-lang="nav_shop">Shop</span></button>
    </div>

    <div id="upgModal" class="modal">
        <div class="modal-card">
            <span class="close-btn" onclick="closeModals()">&times;</span>
            <div class="modal-h text-accent">ARSENAL</div>
            <div id="upgradesList"></div>
        </div>
    </div>

    <div id="tasksModal" class="modal">
        <div class="modal-card">
            <span class="close-btn" onclick="closeModals()">&times;</span>
            <div class="modal-h text-accent">OPERATIONS LOG</div>
            <div class="item-row">
                <div>
                    <div style="font-weight:bold;">Invite Ally</div>
                    <div style="font-size:10px; color:#aaa;">+50,000 UCBG</div>
                </div>
                <button class="btn" onclick="invite()">INVITE</button>
            </div>
            <div class="item-row">
                <div>
                    <div style="font-weight:bold;">Join Division</div>
                    <div style="font-size:10px; color:#aaa;">Telegram Channel</div>
                </div>
                <button class="btn" onclick="TG.openTelegramLink('https://t.me/ucbgcoin_bot')">GO</button>
            </div>
            <div id="dailyTasks"></div>
        </div>
    </div>

    <div id="warModal" class="modal">
        <div class="modal-card">
            <span class="close-btn" onclick="closeModals()">&times;</span>
            <div class="modal-h text-danger">BATTLEFIELD</div>
            <p style="text-align:center; color:#888; font-size:12px;">LOCATION: <span id="locName">DONETSK AIRPORT (Sim)</span></p>
            
            <div style="background:#222; padding:20px; border-radius:10px; text-align:center; margin:10px 0; border:1px solid #444;">
                <div style="font-size:40px;">‚öîÔ∏è</div>
                <h3>PvP ARENA</h3>
                <p style="font-size:12px; color:#aaa;">Coming in Season 2</p>
                <button class="btn" disabled>SEARCHING...</button>
            </div>

            <div class="item-row" style="border-color:var(--danger)">
                <div>
                    <div style="font-weight:bold; color:var(--danger)">PvE: Drone Strike</div>
                    <div style="font-size:10px;">Cost: 1000 Energy</div>
                </div>
                <button class="btn" style="background:var(--danger)" onclick="startPve()">ATTACK</button>
            </div>
        </div>
    </div>

    <div id="shopModal" class="modal">
        <div class="modal-card">
            <span class="close-btn" onclick="closeModals()">&times;</span>
            <div class="modal-h" style="color:#0088cc;">MILITARY AID (TON)</div>
            
            <div class="item-row">
                <div>
                    <div style="font-weight:bold;">VIP STATUS</div>
                    <div style="font-size:10px;">x2 Mining Speed</div>
                </div>
                <button class="btn btn-ton" onclick="buyTon('vip')">5 TON</button>
            </div>
            
            <div class="item-row">
                <div>
                    <div style="font-weight:bold;">1M UCBG Cache</div>
                    <div style="font-size:10px;">Instant Resources</div>
                </div>
                <button class="btn btn-ton" onclick="buyTon('1m')">1 TON</button>
            </div>
             <p style="font-size:10px; color:#555; text-align:center; margin-top:10px;">Proceeds go to virtual development.</p>
        </div>
    </div>
    <script>
        // --- CORE SYSTEM v5.0 ---
        const TG = window.Telegram.WebApp;
        TG.expand(); 
        TG.setHeaderColor('#050505');

        // LOCALIZATION DATABASE
        const TEXTS = {
            uk: {
                title: "–û–±–æ—Ä–æ–Ω–∞ –ö–∏—î–≤–∞",
                bot_status: "–ê–≤—Ç–æ-–¢—É—Ä–µ–ª—å",
                nav_base: "–ë–∞–∑–∞", nav_tasks: "–ù–∞–∫–∞–∑–∏", nav_war: "–§—Ä–æ–Ω—Ç", nav_upg: "–ê—Ä—Å–µ–Ω–∞–ª", nav_shop: "–í—ñ–π—Å—å–∫—Ç–æ—Ä–≥",
                pop_rocket: "üöÄ –†–ê–ö–ï–¢–ù–ò–ô –£–î–ê–†!",
                pop_pve: "üí• –¶—ñ–ª—å –∑–Ω–∏—â–µ–Ω–æ! +5000"
            },
            en: {
                title: "Defense of Kyiv",
                bot_status: "Auto-Turret",
                nav_base: "Base", nav_tasks: "Orders", nav_war: "Front", nav_upg: "Arsenal", nav_shop: "Shop",
                pop_rocket: "üöÄ ROCKET STRIKE!",
                pop_pve: "üí• Target Destroyed! +5000"
            }
        };

        // Detect Language (UA/RU -> UK, else EN)
        const userLang = (TG.initDataUnsafe.user && TG.initDataUnsafe.user.language_code) || 'en';
        const LANG = (userLang === 'uk' || userLang === 'ru') ? 'uk' : 'en';
        const T = TEXTS[LANG];

        // CONFIG & STATE
        const LEAGUES = [
            { name: "Recruit", limit: 0, color: "var(--l-bronze)", loc: "Training Camp" },
            { name: "Soldier", limit: 50000, color: "var(--l-silver)", loc: "Kyiv Outskirts" },
            { name: "Veteran", limit: 500000, color: "var(--l-gold)", loc: "Eastern Front" },
            { name: "Cyborg", limit: 2000000, color: "var(--l-diamond)", loc: "Donetsk Airport" },
            { name: "General", limit: 10000000, color: "var(--l-cyborg)", loc: "Crimea Liberation" }
        ];

        let game = {
            balance: 0,
            energy: 1000,
            leagueIdx: 0,
            hasBot: false,
            botStart: 0,
            turboEnd: 0,
            upgrades: {
                tap: { lvl: 1, base: 500, val: 1 },
                eng: { lvl: 1, base: 500, val: 1000 },
                reg: { lvl: 1, base: 1000, val: 2 }
            }
        };

        // TON CONNECT
        const tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
            manifestUrl: 'https://raw.githubusercontent.com/ton-community/tutorials/main/03-client/test/public/tonconnect-manifest.json',
            buttonRootId: 'ton-connect-btn'
        });
        // --- INIT ---
        function init() {
            // Load Save
            let s = localStorage.getItem('ucbg_v5');
            if(s) game = {...game, ...JSON.parse(s)};
            
            // Set User Info
            if(TG.initDataUnsafe.user) {
                document.getElementById('userName').innerText = TG.initDataUnsafe.user.first_name;
            }

            // Apply Localization
            document.querySelectorAll('[data-lang]').forEach(el => {
                el.innerText = T[el.getAttribute('data-lang')];
            });
            document.getElementById('ui_title').innerText = LEAGUES[game.leagueIdx].loc;

            updateUI();
            renderUpgrades();
            
            // Game Loop
            setInterval(() => {
                // Regen Energy
                if(game.energy < game.upgrades.eng.val) {
                    game.energy = Math.min(game.upgrades.eng.val, game.energy + game.upgrades.reg.val);
                    updateUI();
                }
                updateBot();
                checkTurbo();
            }, 1000);
        }

        // --- CORE GAMEPLAY ---
        const elTap = document.getElementById('tapBtn');
        
        elTap.addEventListener('pointerdown', (e) => {
            e.preventDefault();
            
            let mult = (Date.now() < game.turboEnd) ? 10 : 1;
            let dmg = (game.upgrades.tap.val + (game.upgrades.tap.lvl * 2)) * mult;
            
            if(game.energy >= 1) {
                game.energy -= 1;
                game.balance += dmg;
                
                // Visuals
                showFloat(e.clientX, e.clientY, `+${dmg}`, mult > 1 ? '#ff2a2a' : '#fff');
                elTap.style.transform = "scale(0.95)";
                setTimeout(()=>elTap.style.transform="scale(1)", 80);
                
                if(TG.HapticFeedback) TG.HapticFeedback.impactOccurred(mult > 1 ? 'heavy' : 'light');

                checkLeague();
                updateUI();
                saveGame();
            }
        });

        function showFloat(x, y, txt, col) {
            let el = document.createElement('div');
            el.className = 'float-txt';
            el.textContent = txt;
            el.style.color = col;
            el.style.left = (x - 20) + 'px';
            el.style.top = (y - 40) + 'px';
            document.body.appendChild(el);
            setTimeout(() => el.remove(), 800);
        }

        // --- SYSTEMS ---
        function checkLeague() {
            let nxt = game.leagueIdx + 1;
            if(nxt < LEAGUES.length && game.balance >= LEAGUES[nxt].limit) {
                game.leagueIdx = nxt;
                TG.showAlert(`üéñ PROMOTION: ${LEAGUES[nxt].name}`);
                document.getElementById('ui_title').innerText = LEAGUES[nxt].loc;
            }
        }

        function renderUpgrades() {
            const list = document.getElementById('upgradesList');
            list.innerHTML = '';
            
            // Standard Upgrades
            const items = [
                {id:'tap', n:'Cyber Grip', d:'Damage ++'},
                {id:'eng', n:'Battery Core', d:'Max Energy ++'},
                {id:'reg', n:'Solar Array', d:'Regen Speed ++'}
            ];

            // Special Items
            list.innerHTML += `
            <div class="item-row" style="border-color:var(--danger)">
                <div><div style="font-weight:bold;color:var(--danger)">ROCKET STRIKE</div><div style="font-size:10px">x10 DMG (10s)</div></div>
                <button class="btn" style="background:var(--danger)" onclick="activateTurbo()">FREE</button>
            </div>
            <div class="item-row" style="border-color:var(--primary)">
                <div><div style="font-weight:bold;color:var(--primary)">AUTO-BOT</div><div style="font-size:10px">Offline Mining</div></div>
                <button class="btn" onclick="buyBot()" ${game.hasBot?'disabled':''}>50k</button>
            </div>
            <hr style="border-color:#333">`;

            items.forEach(i => {
                let u = game.upgrades[i.id];
                let cost = Math.floor(u.base * Math.pow(1.8, u.lvl));
                list.innerHTML += `
                <div class="item-row">
                    <div><div style="font-weight:bold;">${i.n} <span style="color:var(--primary)">Lvl ${u.lvl}</span></div><div style="font-size:10px;color:#888">${i.d}</div></div>
                    <button class="btn" onclick="buyUpg('${i.id}', ${cost})">${formatNum(cost)}</button>
                </div>`;
            });
        }

        window.buyUpg = (id, cost) => {
            if(game.balance >= cost) {
                game.balance -= cost;
                game.upgrades[id].lvl++;
                if(id === 'eng') game.upgrades.eng.val += 500;
                if(id === 'reg') game.upgrades.reg.val += 2;
                renderUpgrades(); updateUI(); saveGame();
            }
        };

        window.activateTurbo = () => {
            if(Date.now() < game.turboEnd) return;
            game.turboEnd = Date.now() + 10000;
            closeModals();
            TG.showAlert(T.pop_rocket);
        };

        window.buyBot = () => {
            if(game.balance >= 50000 && !game.hasBot) {
                game.balance -= 50000;
                game.hasBot = true;
                game.botStart = Date.now();
                renderUpgrades(); updateUI();
            }
        };

        window.startPve = () => {
            if(game.energy >= 1000) {
                game.energy -= 1000;
                let win = 5000;
                game.balance += win;
                TG.showAlert(T.pop_pve);
                updateUI();
            } else {
                TG.showAlert("‚ö†Ô∏è Low Battery!");
            }
        };
        
        // Mock TON Payment
        window.buyTon = (item) => {
            TG.showConfirm("Proceed to TON Transaction?", (ok) => {
                if(ok) {
                    setTimeout(() => {
                        TG.showAlert("‚úÖ Payment Successful! (Simulation)");
                        if(item === '1m') game.balance += 1000000;
                        updateUI();
                    }, 1000);
                }
            });
        };

        // --- UTILS ---
        function updateUI() {
            document.getElementById('displayBalance').innerText = game.balance.toLocaleString();
            document.getElementById('energyFill').style.width = (game.energy / game.upgrades.eng.val * 100) + "%";
            document.getElementById('enVal').innerText = Math.floor(game.energy);
            document.getElementById('enMax').innerText = game.upgrades.eng.val;
            
            let lg = LEAGUES[game.leagueIdx];
            let badge = document.getElementById('leagueDisplay');
            badge.innerText = `üèÜ ${lg.name}`;
            badge.style.color = lg.color;
            badge.style.borderColor = lg.color;

            // League Visuals
            if(game.leagueIdx >= 3) elTap.classList.add('mode-diamond');
            
            // Turbo Visuals
            if(Date.now() < game.turboEnd) {
                document.getElementById('turboMsg').style.display = 'block';
                elTap.classList.add('mode-war');
            } else {
                document.getElementById('turboMsg').style.display = 'none';
                elTap.classList.remove('mode-war');
            }
        }

        function updateBot() {
            if(!game.hasBot) return;
            document.getElementById('botPanel').style.display = 'flex';
            let diff = Date.now() - game.botStart;
            if(diff > 14400000) { // 4 hours
                document.getElementById('botTimer').innerText = "FULL";
                document.getElementById('botTimer').style.color = "#0f0";
            } else {
                document.getElementById('botTimer').innerText = new Date(14400000 - diff).toISOString().substr(11, 8);
                document.getElementById('botTimer').style.color = "#fff";
            }
        }
        
        window.claimBot = () => { game.balance += 25000; game.botStart = Date.now(); updateUI(); saveGame(); }
        window.saveGame = () => localStorage.setItem('ucbg_v5', JSON.stringify(game));
        window.formatNum = (n) => n > 1000000 ? (n/1000000).toFixed(1)+'M' : (n > 1000 ? (n/1000).toFixed(1)+'k' : n);
        
        window.openModal = (id) => document.getElementById(id).style.display = 'flex';
        window.closeModals = () => document.querySelectorAll('.modal').forEach(el => el.style.display = 'none');
        window.invite = () => TG.openTelegramLink("https://t.me/share/url?url=https://t.me/ucbgcoin_bot");

        window.onload = init;
        
        function checkTurbo() { /* Handled in updateUI */ }
    </script>
</body>
</html>
